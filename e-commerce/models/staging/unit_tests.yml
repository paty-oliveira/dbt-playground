unit_tests:
  - name: test_distribution_centers
    description: It reflect 1:1 relationship between source and staging model of Distribution Centers data.
    model: stg_distribution_centers
    given:
      - input: source('the-look-e-commerce', 'distribution_centers')
        rows:
          - {
              id: 1,
              name: "New Orleans LA",
              latitude: 29.95,
              longitude: -90.0667,
              distribution_center_geom: "ST_GEOGPOINT(-90.0667, 29.95)",
            }
          - {
              id: 2,
              name: "Houston TX",
              latitude: 29.7604,
              longitude: -95.3698,
              distribution_center_geom: "ST_GEOGPOINT(-95.3698, 29.7604)",
            }
    expect:
      rows:
        - {
            distribution_center_id: 1,
            name: "New Orleans LA",
            latitude: 29.95,
            longitude: -90.0667,
            localization_point: "ST_GEOGPOINT(-90.0667, 29.95)",
          }
        - {
            distribution_center_id: 2,
            name: "Houston TX",
            latitude: 29.7604,
            longitude: -95.3698,
            localization_point: "ST_GEOGPOINT(-95.3698, 29.7604)",
          }
