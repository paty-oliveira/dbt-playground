unit_tests:
  - name: unit_test_fct_orders
    description: It should return order detailed information such as status, total order items, total order value and so on.
    model: fct_orders
    given:
      - input: ref('stg_orders')
        format: sql
        fixture: input_stg_orders__fct_orders
      - input: ref('stg_order_items')
        format: sql
        fixture: input_stg_order_items__fct_orders
    expect:
      format: sql
      fixture: expected_fct_orders

  - name: unit_test_fct_order_items
    description: It should return order item-level information, with enriched product details.
    model: fct_order_items
    given:
      - input: ref('stg_order_items')
        format: sql
        fixture: input_stg_order_items__fct_order_items
      - input: ref('stg_products')
        format: sql
        fixture: input_stg_products__fct_order_items
    expect:
      format: sql
      fixture: expected_fct_order_items
